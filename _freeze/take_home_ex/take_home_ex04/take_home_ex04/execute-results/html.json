{
  "hash": "384103c209900ee9341973b8aa2ead06",
  "result": {
    "markdown": "---\ntitle: \"Take-Home Exercise 4\"\nauthor: \"Chai Zhixuan\"\ndate: 2024-02-28\ndate-format: long\ndate-modified: \"last-modified\"\nexecute: \n  eval: true\n  echo: true\n  freeze: true\n  warning: false\n  message: false\n---\n\n\n# 1 Overview\n\nThis take-home exercise will be selecting one of the module of my team's [project](https://isss608-team13.netlify.app/proposal#data-visualisation-methods) proposed Shiny application. I will be working on storyboard 3: geospatial analysis\n\n# **2. Setting the Analytical Tools**\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(sf,  readxl, tmap, tidyverse)\n```\n:::\n\n\n# 3. Data Preparation \n\n## **3.1 The data**\n\n-   The first dataset will from [Energy Market Authority](#0). I am using the tidy data.\n\n    ![](images/1-05.PNG)\n\n![]()\n\n-   The second dataset will be Master Plan 2019 Subzone Boundary (Web) (i.e. `MP14_SUBZONE_WEB_PL`) in ESRI shapefile format. It can be downloaded at [data.gov.sg](https://data.gov.sg/) This is a geospatial data. It consists of the geographical boundary of Singapore at the planning subzone level. The data is based on URA Master Plan 2019.\n\n-   The third dataset will be population data\n\n## **3.2 Data Import and Preparation**\n\n### **3.2.1 Importing Geospatial Data into R**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz <- st_read(dsn = \"data/geospatial\", \n                layer = \"MPSZ-2019\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nReading layer `MPSZ-2019' from data source \n  `C:\\czx0727\\ISSS608-VAA\\take_home_ex\\take_home_ex04\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 332 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nGeodetic CRS:  WGS 84\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSimple feature collection with 332 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nGeodetic CRS:  WGS 84\nFirst 10 features:\n                 SUBZONE_N SUBZONE_C       PLN_AREA_N PLN_AREA_C       REGION_N\n1              MARINA EAST    MESZ01      MARINA EAST         ME CENTRAL REGION\n2         INSTITUTION HILL    RVSZ05     RIVER VALLEY         RV CENTRAL REGION\n3           ROBERTSON QUAY    SRSZ01  SINGAPORE RIVER         SR CENTRAL REGION\n4  JURONG ISLAND AND BUKOM    WISZ01  WESTERN ISLANDS         WI    WEST REGION\n5             FORT CANNING    MUSZ02           MUSEUM         MU CENTRAL REGION\n6         MARINA EAST (MP)    MPSZ05    MARINE PARADE         MP CENTRAL REGION\n7                   SUDONG    WISZ03  WESTERN ISLANDS         WI    WEST REGION\n8                  SEMAKAU    WISZ02  WESTERN ISLANDS         WI    WEST REGION\n9           SOUTHERN GROUP    SISZ02 SOUTHERN ISLANDS         SI CENTRAL REGION\n10                 SENTOSA    SISZ01 SOUTHERN ISLANDS         SI CENTRAL REGION\n   REGION_C                       geometry\n1        CR MULTIPOLYGON (((103.8802 1....\n2        CR MULTIPOLYGON (((103.8376 1....\n3        CR MULTIPOLYGON (((103.8341 1....\n4        WR MULTIPOLYGON (((103.7125 1....\n5        CR MULTIPOLYGON (((103.8472 1....\n6        CR MULTIPOLYGON (((103.8987 1....\n7        WR MULTIPOLYGON (((103.7235 1....\n8        WR MULTIPOLYGON (((103.76 1.21...\n9        CR MULTIPOLYGON (((103.8591 1....\n10       CR MULTIPOLYGON (((103.8232 1....\n```\n:::\n:::\n\n\n###  **3.2.2 Importing Attribute Data into R**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSES_2 <- read_excel(\"data/SES_Public_2023_tidy.xlsx\", sheet = \"T3.5\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nstr(SES_2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ntibble [70,706 × 6] (S3: tbl_df/tbl/data.frame)\n $ dwelling_type: chr [1:70706] \"1-room / 2-room\" \"1-room / 2-room\" \"1-room / 2-room\" \"1-room / 2-room\" ...\n $ year         : num [1:70706] 2005 2005 2005 2005 2005 ...\n $ month        : chr [1:70706] \"1\" \"1\" \"1\" \"1\" ...\n $ Region       : chr [1:70706] \"Central Region\" \"Central Region\" \"Central Region\" \"Central Region\" ...\n $ Description  : chr [1:70706] \"Bishan\" \"Bukit Merah\" \"Central Region\" \"Geylang\" ...\n $ kwh_per_acc  : num [1:70706] 105 141 136 148 116 ...\n```\n:::\n:::\n\n\nI will keep to 2023, and overall with annual data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSES_2_1 <- SES_2 %>%\n  filter(year == 2023, month == \"Annual\", dwelling_type == \"Overall\", Description != \"Central Region\", Description != \"North Region\", Description != \"North East Region\",Description != \"Overall\", Description != \"West Region\")\n```\n:::\n\n\nConvert areas to upper case.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSES_2_1 <- SES_2_1 %>%\n  mutate_at(.vars = vars(Description), \n          .funs = funs(toupper))\n```\n:::\n\n\n### **3.2.3 Creating a sf data frame from an aspatial data frame**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz_SES <- left_join(mpsz, SES_2_1,\n                          by = c(\"PLN_AREA_N\" = \"Description\"))\n```\n:::\n\n\nI will remove rows with na.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmpsz_SES_filtered <- mpsz_SES %>%\n  mutate(kwh_per_acc = coalesce(kwh_per_acc, 0),dwelling_type = coalesce(dwelling_type, \"NA\"))%>%\n  select(dwelling_type,kwh_per_acc, geometry) \n```\n:::\n\n\n# 4 Preliminary visualisation\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntmap_mode(\"plot\")\ntmap_options(check.and.fix = TRUE)\nqtm(mpsz_SES_filtered, \n    fill = \"kwh_per_acc\")\n```\n\n::: {.cell-output-display}\n![](take_home_ex04_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntm_shape(mpsz_SES_filtered)+\n  tm_fill(\"kwh_per_acc\", \n          style = \"quantile\", \n          palette = \"Blues\",\n          title = \"Electricity Consumption in kwh_per_acc\") +\n  tm_layout(main.title = \"Total Household Electricity Consumption by Household in 2023\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            legend.height = 0.45, \n            legend.width = 0.35,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5) +\n  tm_compass(type=\"8star\", size = 2) +\n  tm_scale_bar() +\n  tm_grid(alpha =0.2) +\n  tm_credits(\"Source: Planning Sub-zone boundary from Urban Redevelopment Authorithy (URA)\\n and electricity data from Energy Marketing Authority (EMA)\", \n             position = c(\"left\", \"bottom\"))\n```\n\n::: {.cell-output-display}\n![](take_home_ex04_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n# 5. Selection of data visualisation techniques used\n\n# 6. Data visualisation design and interactivity principles and best practices implemented\n\n# 7. UI design \n\n# 8. R Shiny\n",
    "supporting": [
      "take_home_ex04_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}